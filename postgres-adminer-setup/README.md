# PostgreSQL + Adminer Setup

–≠—Ç–æ standalone –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ PostgreSQL —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º Adminer.

## üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### PostgreSQL
- **–•–æ—Å—Ç**: localhost
- **–ü–æ—Ä—Ç**: 18788
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: sgr_memory_vault
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: admin
- **–ü–∞—Ä–æ–ª—å**: Lol770905!

### Adminer (–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **URL**: http://localhost:18789
- **–°–∏—Å—Ç–µ–º–∞**: PostgreSQL
- **–°–µ—Ä–≤–µ—Ä**: postgres:18788
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: admin
- **–ü–∞—Ä–æ–ª—å**: Lol770905!
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: sgr_memory_vault

## üöÄ –ó–∞–ø—É—Å–∫

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
```bash
docker-compose up -d
```

### –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:

**–ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```bash
docker exec -i sgr-postgres-standalone psql -U admin -d sgr_memory_vault < sample_data.sql
```

**–î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∑–∞ —è–Ω–≤–∞—Ä—å 2025:**
```bash
docker exec -i sgr-postgres-standalone psql -U admin -d sgr_memory_vault < monthly_report_data.sql
```

**–ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
```bash
# –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª example_queries.sql –≤ Adminer –∏–ª–∏ –ª—é–±–æ–º SQL –∫–ª–∏–µ–Ω—Ç–µ
# –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
docker-compose logs -f
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
docker-compose ps
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
```bash
docker-compose down
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
```bash
docker-compose down -v
```

## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### Python (psycopg2)
```python
import psycopg2

conn = psycopg2.connect(
    host="localhost",
    port=18788,
    database="sgr_memory_vault",
    user="admin",
    password="Lol770905!"
)
```

### Python (SQLAlchemy)
```python
from sqlalchemy import create_engine

engine = create_engine(
    "postgresql://admin:Lol770905!@localhost:18788/sgr_memory_vault"
)
```

### Connection String
```
postgresql://admin:Lol770905!@localhost:18788/sgr_memory_vault
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
postgres-adminer-setup/
‚îú‚îÄ‚îÄ docker-compose.yml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îú‚îÄ‚îÄ init_db.sql          # SQL —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ sample_data.sql      # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .env.example         # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md            # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (Dictionaries)
- **dict_functions** - –§—É–Ω–∫—Ü–∏–∏ SMT –¥–ª—è —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏
- **dict_tribes** - –¢—Ä–∞–π–±—ã
- **dict_cfo** - –¶–µ–Ω—Ç—Ä—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **dict_expense_items** - –°—Ç–∞—Ç—å–∏ –∑–∞—Ç—Ä–∞—Ç —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π
- **dict_currencies** - –í–∞–ª—é—Ç—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **capex_it_budget** - –ë—é–¥–∂–µ—Ç—ã CAPEX IT —Å –ø–æ–º–µ—Å—è—á–Ω–æ–π —Ä–∞–∑–±–∏–≤–∫–æ–π
- **budget_actuals** - –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –±—é–¥–∂–µ—Ç—É —Å –ø–ª–∞–Ω–æ–º –∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º–∏
- **app_logs** - –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∞—É–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏–π

### –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Views)
- **v_capex_monthly_analysis** - –ê–Ω–∞–ª–∏–∑ CAPEX –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –∫–≤–∞—Ä—Ç–∞–ª–∞–º
- **v_budget_execution_summary** - –°–≤–æ–¥–∫–∞ –ø–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –±—é–¥–∂–µ—Ç–∞

### –§—É–Ω–∫—Ü–∏–∏
- **calculate_capex_monthly_total()** - –†–∞—Å—á–µ—Ç —Å—É–º–º—ã –≤—Å–µ—Ö –º–µ—Å—è—Ü–µ–≤
- **log_operation()** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥
- **update_updated_at_column()** - –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ timestamps

## üóÑÔ∏è –î–∞–Ω–Ω—ã–µ

–í—Å–µ –¥–∞–Ω–Ω—ã–µ PostgreSQL —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Docker volume `postgres_data` –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

## ‚úÖ Healthcheck

PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç healthcheck, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥.

## üîß Troubleshooting

### –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã
–ï—Å–ª–∏ –ø–æ—Ä—Ç—ã 18788 –∏–ª–∏ 18789 —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, –∏–∑–º–µ–Ω–∏—Ç–µ –∏—Ö –≤ `docker-compose.yml`:
```yaml
ports:
  - "–ù–û–í–´–ô_–ü–û–†–¢:18788"  # –¥–ª—è postgres
  - "–ù–û–í–´–ô_–ü–û–†–¢:8080"   # –¥–ª—è adminer
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã:
```bash
docker-compose ps
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs postgres
docker-compose logs adminer
```
